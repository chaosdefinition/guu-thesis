%% LaTeX source of the thesis.
%% Use command 'xelatex --shell-escape guu-thesis.tex' TWICE to compile it into a PDF.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% document preamble %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[12pt]{ucthesis}

\usepackage[UTF8, scheme = plain]{ctex}	% for svg bug fix
\usepackage{amsmath}			% for mathematical features
\usepackage{amssymb}			% for mathematical symbols
\usepackage{amsthm}			% for theorems
\usepackage{enumerate}			% for customized list numbering
\usepackage{hyperref}			% for bookmarks and hyperlinks
\usepackage[all]{hypcap}		% for correction of figure link targets
\usepackage{svg}			% for svg images

% hyperref options
\hypersetup{
	% hide links
	hidelinks,
	% number bookmarks
	bookmarksnumbered = true,
	% fit width
	pdfstartview = {FitH},
	% PDF title
	pdftitle = {Ching-Jung Guu's Doctorate Thesis},
	% PDF subject
	pdfsubject = {The Circular Wirelength Problem for Hypercubes},
	% PDF author
	pdfauthor = {Ching-Jung Guu}
}

% \renewcommand{\theequation}{$\mathcal{\Alph{equation}}$}
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}

% theorems
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}
\newtheorem{claim}{Claim}
\newtheorem{proposition}{Proposition}
\newtheorem*{note}{Note}

\theoremstyle{definition}
\newtheorem{definition}{Definition}

% svg options
\setsvg{
	svgpath = {./images/},		% svg directory
	inkscape = {inkscape -z -D}	% Inkscape command
}

% symbol of the Takagi function
\newcommand{\takagi}{
  \texorpdfstring{\protect\includesvg[height = 0.6\baselineskip]{takagi}}{M}
}

% thesis information
\title{The Circular Wirelength Problem for Hypercubes}
\author{Ching-Jung Guu}
\degreeyear{1997}
\degreesemester{December}
\degree{Doctor of Philosophy}
\chair{L. H. Harper}
\othermembers{
	N. E. Gretsky \\
	A. R. Stralka
}
\numberofmembers{3}
\field{Mathematics}
\campus{Riverside}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% document body %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% cover pages %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\maketitle
\approvalpage
\copyrightpage

\begin{frontmatter}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Abstract %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{abstract}
The circular wirelength problem is defined;
the special case for hypercubes is solved.
A continuous analog of the solution of the discrete isoperimetric problem
for hypercubes is also defined, and its properties discussed.
\end{abstract}

\tableofcontents

\end{frontmatter}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Chapter 1 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Introduction}
\label{Chapter 1}

A graph $G = (V_G, E_G, \partial_G)$ is a triple,
with $V_G$ being the set of vertices, $E_G$, the set of edges,
and $\partial_G \colon E_G \rightarrow \binom{V_G}{2}$,
a map from the edge set to 2-element subset of the vertices.
$\partial_G$ tells us which two vertices are incident to a given edge.

Given $v, w \in V_G$,
\begin{definition}
\label{Definition 1}
$d_G(v, w)$, the \emph{distance} from $v$ to $w$,
is the length of the shortest path from $v$ to $w$ in $G$.
\end{definition}

The wirelength problem is a graph embedding problem which is defined as the following.

Given two graphs, $G = (V_G, E_G, \partial_G)$ and $H = (V_H, E_H, \partial_H)$,
with $|V_G| \le |V_H|$ and $\eta \colon V_G \rightarrow V_H$,
one-to-one from $V_G$ into $V_H$:
\begin{definition}
\label{Definition 2}
\begin{equation*}
wl(G, H; \eta) = \sum_{\substack{
	e \in E \\
	\partial(e) = \{v, w\}
}} d_H(\eta(v), \eta(w))
\end{equation*}
is the \emph{wirelength of $G$ into $H$ with respect to $\eta$}.
\end{definition}
\begin{definition}
\label{Definition 3}
The \emph{wirelength of $G$ into $H$}, $wl(G, H)$, is
\begin{equation*}
wl(G, H) = \min_{\eta \colon V_G \rightarrow V_H} wl(G, H; \eta).
\end{equation*}
\end{definition}

The wirelength problem is to find $wl(G, H)$,
together with the map $\eta$ which achieves the minimum wirelength.

The classic wirelength problem for hypercubes,
where the $n$-dimensional hypercube is embedded into a linear path of length $2^n$,
was solved by L. H. Harper in \cite{Harper.1964} in 1964.
Here we present the solution for the circular wirelength problem of hypercubes,
where the $n$-dimensional hypercube is embedded into a circuit of length $2^n$.

The general graph embedding problem is NP-complete,
in fact when the target graph of the embedding problem is a path,
it is already NP-complete \cite{Garey.1979}.
It is clear that the circular wirelength is no greater than the linear wirelength for any graph.
A proof that the circular wirelength for trees is the same as the classical wirelength
has recently been presented by S. L. Bezrukov, and U.-P. Schroeder in \cite{Bezrukov.1998}.
The results here show such is not the case for hypercubes.
The circular wirelength for hypercubes is about three fourths that of the linear wirelength.
We note that the circular wirelength for any graph is at least one half its linear wirelength,
and this lower bound is achieved by complete graphs.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Chapter 2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Preliminaries}
\label{Chapter 2}

\section{The Circular Wirelength Problem}
\label{Section 2.1}

We first define the domain and the target graph of our embedding problem,
the hypercubes and the circuits.

The hypercube of dimension $n$, we denote by $Q_n$.
$Q_n = (V_n, E_n, \partial_n)$,
$V_n = \{(v_1, v_2, \dots, v_n) = v \colon v_i \in \{0, 1\}\}$ and for $e \in E_n$,
$\partial_n(e) = \{v, w\}$ iff $v$ and $w$ differ in exactly one coordinate.

The circuit of length $n$, we denote by $C_n$.
The vertices of the circuit are labeled $1, 2$ through $n$ in order.
$C_n = (V_{C_n}, E_{C_n}, \partial_{C_n})$,
$V_{C_n} = \{1, 2, \dots, n\}$ and $E_{C_n} = \{e_1, e_2, \dots, e_n\}$,
with $\partial_{C_n}(e_k) = \{k, k + 1\}$ when $1 \le k < (n - 1)$,
and $\partial_{C_n}(e_n) = \{n, 1\}$.

$|V|$ is the integer which denotes the cardinality of $V$,
\begin{definition}
\label{Definition 4}
Let $G = (V, E, \partial)$.
The wirelength of $G$ into $C_{|V|}$ is called the \emph{circular wirelength} of $G$.
\end{definition}
\begin{definition}
\label{Definition 5}
A one-to-one and onto function $\eta \colon V \rightarrow \{1, 2, \dots, |V|\}$
is also called a \emph{numbering} of $V$.
\end{definition}

Our goal is to find the circular wirelength of $Q_n$,
the solution to the circular wirelength problem of $Q_n$.

\section{The Discrete Isoperimetric Problem}
\label{Section 2.2}

Given $G = (V, E, \partial)$ a finite graph.
For $S \subseteq V$, define
\begin{equation*}
\theta(S) = |\{e \in E \colon \partial(e) = \{v, w\}, v \in S, w \notin S\}|.
\end{equation*}
The discrete isoperimetric problem is to find a subset which has the minimum $\theta$ value
over all subsets of the same cardinality.
The subset, together with its $\theta$ value,
is a solution to the discrete isoperimetric problem for the subset's cardinality.
So, for each $k$, $0 \le k \le |V|$,
a solution of the discrete isoperimetric problem is the pair $(S, \theta(S))$ where
\begin{equation*}
\theta(S) \le \theta(T), \textnormal{for all }T \subseteq V, |T| = |S| = k.
\end{equation*}
Note that a solution, $(S, \theta(S))$,
provides a unique number $\theta(S)$ as the minimum,
but the set $S$ need not be unique.
We may also express the solution
\begin{equation*}
\theta(S) = \min_{T \in \binom{V}{k}} \theta(T).
\end{equation*}
We often refer to either $S$ or $\theta(S)$ without being explicit,
when we speak of a solution.
Whether it is the set or the number that we want should be clear by context.

A number of problems in graph theory are translated and solved as discrete isoperimetric problems.
In particular, graph embedding problems are transformed to minimum path problems
on the \emph{derived network} of the embedding problem.
The classical wirelength problem was solved in this fashion.
For examples and solutions in this area,
including more detailed exposition of all terminology, see \cite{Harper.2004}.

The circular wirelength problem for hypercubes is no exception;
the first step in our solution is the translation to its derived network.
We will set up the derived network in the following section.

\section{The Derived Network}
\label{Section 2.3}

We first establish the following equality relating the wirelength to the discrete isoperimetric problem,
\begin{claim}
\label{Claim 1}
\begin{equation*}
wl(Q_n, C_{2^n}; \eta) = \sum_{i = 1}^{2^{n - 1}} \theta(\eta^{-1}\{i, i + 1, \dots, i + (2^{n - 1} - 1)\}).
\end{equation*}
\end{claim}

\begin{proof}
Let $e \in E_n$, an edge of $Q_n$,
and $S \subset V_n$, a subset of the vertices of $Q_n$, define
\begin{equation*}
\delta(e, S) = \begin{cases}
	1 & \textnormal{if } \partial(e) = \{v, w\}, v \in S, w \notin S. \\
	0 & \textnormal{otherwise}.
\end{cases}
\end{equation*}
With this definition, we have
\begin{equation*}
\sum_{e \in E_n} \delta(e, S) = \theta(S).
\end{equation*}

Let $S_i = \eta^{-1}\{i, i + 1, \dots, i + (2^{n - 1} - 1)\}$,
and let $\partial(e) = \{v, w\}$,
\begin{equation*}
\sum_{i = 1}^{2^{n - 1}} \delta(e, S_i) = d_{C_n}(\eta(v), \eta(w)).
\end{equation*}
Therefore
\begin{align*}
wl(Q_n, C_{2^n}; \eta)
& = \sum_{e \in E_n} d_{C_n}(\eta(v), \eta(w)) \\
& = \sum_{e \in E_n} \sum_{i = 1}^{2^{n - 1}} \delta(e, S_i) \\
& = \sum_{i = 1}^{2^{n - 1}} \sum_{e \in E_n} \delta(e, S_i) \\
& = \sum_{i = 1}^{2^{n - 1}} \theta(S_i) \\
& = \sum_{i = 1}^{2^{n - 1}} \theta(\eta^{-1}\{i, i + 1, \dots, i + (2^{n - 1} - 1)\}).
\end{align*}
\end{proof}

Note that the sum on the right is $2^{n - 1}$ summands of $\theta$ of subsets of
cardinality $2^{n - 1}$ in $V_n$.

The derived network of this embedding problem is the vertex-weighted graph $D = (V_D, E_D, \partial_D)$,
where $V_D$ consists of all subsets of $V_n$ of cardinality $2^{n - 1}$,
and $e \in E_D$ with $\partial_D(e) = \{V, W\}$, if $V \Delta W = 2$.
The weight of each vertex $V \in V_D$ is $\theta(V)$.

A path in $D$, starting at any vertex $P$ and ending at the vertex $P^C$,
with length exactly $2^{n - 1}$,
is denoted by $P = \{P_1, P_2, \dots, P_{2^{n - 1}}, P_1^C\}$.
$P$ corresponds to a numbering $\eta_P \colon V_n \rightarrow V_{C_{2^n}}$ in the following way:
\begin{align*}
\eta_P(P_1 \backslash P_2) = 1, & \textnormal{ and }
\eta_P(P_2 \backslash P_1) = 2^{n - 1}, \\
\eta_P(P_2 \backslash P_3) = 2, & \textnormal{ and }
\eta_P(P_3 \backslash P_2) = 2^{n - 1} + 1, \\
\cdots \\
\eta_P(P_{2^{n - 1} - 1} \backslash P_{2^{n - 1}}) = 2^{n - 1} - 1, & \textnormal{ and }
\eta_P(P_{2^{n - 1}} \backslash P_{2^{n - 1} - 1}) = 2^n - 2.
\end{align*}
Note that in this way,
\begin{align*}
P_1 & = \eta_P^{-1}\{1, 2, \dots, 2^{n - 1}\}, \\
P_2 & = \eta_P^{-1}\{2, 3, \dots, 2^{n - 1} + 1\}, \\
P_3 & = \eta_P^{-1}\{3, 4, \dots, 2^{n - 1} + 2\}, \\
& \cdots \\
P_{2^{n - 1}} & = \eta_P^{-1}(\{2^{n - 1}, 2^{n - 1} + 1, \dots, 2^n - 1\}).
\end{align*}
Since
\begin{align*}
wl(Q_n, C_{2^n}; \eta_P)
& = \sum_{i = 1}^{2^{n - 1}} \theta(\eta^{-1}\{i, i + 1, \dots, i + (2^{n - 1} - 1)\}) \\
& = \theta(P_1) + \theta(P_2) + \cdots + \theta(P_{2^{n - 1}}),
\end{align*}
$P = \{P_1, P_2, \dots, P_{2^{n - 1}}, P_1^C\}$ in our derived network has weight
equal to that of the $wl(Q_n, C_{2^n}; \eta_P)$.
Solving the circular wirelength problem is the same as finding the minimum
of all such shortest paths from a set to its complement in our derived network.

\section{Type of a Subset}
\label{Section 2.4}

Given any $S \subseteq V_n$,
consider all possible $(n - 1)$-dimensional subcubes of $Q_n$.
There are $2 n$ such subcubes.
Let us denote these by $H_i$.
\begin{equation*}
Type(S) = \min_{1 \le i \le 2 n} |S \cap H_i|.
\end{equation*}

We pay special attention to subsets of cardinality $2^{n - 1}$,
for vertices of our derived network are such sets.
The possible types for these subsets ranges from $0$ to $2^{n - 2}$.
For example, $(n - 1)$-dimensional subcubes are of type $0$,
and the parity subsets are of type $2^{n - 2}$.
We divide the subsets of cardinality $2^{n - 1}$ into two categories by their types.
We will call subsets having types between and including $0$ and $2^{n - 3}$ \emph{small} and others \emph{big}.
We abuse the terminology when it comes to a subset of type $2^{n - 3}$,
it is both \emph{big} and \emph{small}.

\section{Properties of a Path}
\label{Section 2.5}

Let $P = \{P_1, P_2, \dots, P_{2^{n - 1}}, P_1^C\}$ be a path in our derived network.
We associate with $P$,
\begin{definition}
\label{Definition 6}
If $P$ is a path, its \emph{type sequence} is
\begin{equation*}
T_P = \{Type(P_1), Type(P_2), \dots, Type(P_{2^{n - 1}})\}.
\end{equation*}
\end{definition}

The type sequence of a path, $T_P = \{t_1, t_2, \dots, t_{2^{n - 1}}\}$,
has some nice properties.
\begin{proposition}
\label{Proposition 1}
\hfill
\begin{enumerate}[(i)]
	\item\label{Proposition 1.i} $T_P$ is continuous, and
	\item\label{Proposition 1.ii} There exist at least two $i$ with $t_i \ge 2^{n - 3}$.
\end{enumerate}
\end{proposition}
\begin{proof}
(\ref{Proposition 1.i}) The types of neighbors in a path are either the same
or they differ by $1$,
since the neighbors in our derived network have a symmetric difference of two.

For (\ref{Proposition 1.ii}),
let $P = \{P_1, P_2, \dots, P_{2^{n - 1}}, P_1^C\}$ be a path in our derived network,
with type sequence $T_P = \{t_1, t_2, \dots, t_{2^{n - 1}}\}$.
We first observe that $P_i$ is distance $(j - i)$ away from $P_j$,
and neighbors on a path are close to the same subcube if both have type strictly smaller than $2^{n - 3}$.

A type sequence must not have a subsequence of length greater than $2^{n - 2}$
with elements that are strictly smaller than $2^{n - 3}$.
If this is the case,
let $T_S = \{t_i, t_{i + 1}, \dots, t_j\}$ be the subsequence.
Distance between $t_i$ and $t_j$ is on the one hand $j - i > 2^{n - 2}$,
but the same as the distance from $P_i$ to the common subcube
plus the distance from the subcube to $P_j$,
which is $t_i + t_j < 2^{n - 2}$.
A path with length $2^{n - 1}$ must have at least two sets that are type \emph{big}.
\end{proof}

\section{The Greycode}
\label{Section 2.6}

The Greycode, $\mathcal{G} \colon V_n \rightarrow V_{C_{2^n}}$,
is defined recursively.
If $Q_{n - 1}$ is given together with the numbering,
we think of numbering $Q_n$ as adding a neighbor to each vertex of the $Q_{n - 1}$,
the new vertices give another copy of $Q_{n - 1}$.
The numbering on the new $Q_{n - 1}$, starting with $2^{n - 1} + 1$,
is the reverse of the original,
with the neighbor of vertex numbered $2^{n - 1}$ numbered first as $2^{n - 1} + 1$,
and neighbor of vertex numbered $1$ numbered last as $2^n$.
The path which corresponds to the greycode in our derived network,
$G = \{G_1, G_2, \dots, G_{2^{n - 1}}, G_1^C\}$, has type sequence
\begin{equation*}
T_G = \{0, 1, 2, \dots, 2^{n - 3}, (2^{n - 3} - 1), \dots, 0, 1, 2, \dots, 2^{n - 3}, (2^{n - 3} - 1), \dots, 0\}.
\end{equation*}
They are all of type \emph{small}, exactly two of type $0$ and $2^{n - 3}$,
and exactly four of type $t$, $0 < t < 2^{n - 3}$.

\section{Reduction to Inequalities}
\label{Section 2.7}

Let $\theta(n, k, t)$ denote the solution to the discrete isoperimetric problem
for a subset of cardinality $k$, type $t$, in $Q_n$.
We first calculate a bound for $\theta(n, k, t)$.
\begin{equation}
\label{Equation 2.1}
\theta(n, k, t) \ge \theta(n - 1, t) + \theta(n - 1, k - t) + k - 2 t,
\end{equation}
if we divide $Q_n$ into two halves,
with one of the $Q_{n - 1}$ intersecting the set at $t$ places.
The $\theta$ values of the halves are bounded below by the first two terms on the right,
and the edges going across the two halves are bounded below by the third.

We are particularly interested in subsets of cardinality $2^{n - 1}$,
since those are the sets in our derived network.
When the cardinality of the set is $2^{n - 1}$, we have the special case,
\begin{equation}
\label{Equation 2.2}
\theta(n, 2^{n - 1}, t) \ge \theta(n - 1, t) + \theta(n - 1, 2{n - 1} - t) + 2^{n - 1} - 2 t.
\end{equation}

Let $\theta(n, k)$ denote the solution to the discrete isoperimetric problem
for cardinality $k$ in the $n$-dimensional cube, $Q_n = (V_n, E_n, \partial_n)$.
\begin{equation*}
\theta(n, k) = \min_{S \in \binom{V_n}{k}} \theta(S).
\end{equation*}
A corollary of Harper's solution to the discrete isoperimetric problem for cubes in \cite{Harper.1964},
gives us a recursive formula for $\theta(n, k)$:
\begin{equation*}
\theta(n, k) = \begin{cases}
	\theta(n - 1, k) + k & \textnormal{if } 0 \le k \le 2^{n - 1}; \\
	\theta(n, 2^n - k) &  \textnormal{if } 2^{n - 1} \le k \le 2^n.
\end{cases}
\end{equation*}
Using this formula, we simplify our special case (\ref{Equation 2.2}) to
\begin{equation*}
\theta(n, 2^{n - 1}, t) \ge 2 \cdot \theta(n - 1, t) + (2^{n - 1} - 2 t).
\end{equation*}

We note that each set in the path of the greycode achieves the minimum $\theta$ value
on the right hand side of the inequality.
These sets are of \emph{small} type, types between $0$ and $2^{n - 3}$;
we know exactly what they look like.
However, when the type of the set is greater than $2^{n - 3}$,
we no longer have an obvious bound and interpretation for them.

What we want to establish is a bound for the sets of \emph{big} types,
types between $2^{n - 3}$ and $2^{n - 2}$.
If we could show for $2^{n - 3} \le t \le 2^{n - 2}$,
\begin{equation}
\label{Equation 2.3}
\theta(n, 2^{n - 1}, t) \ge \frac{3}{4} \cdot 2^n,
\end{equation}
we may then consider paths which contain only sets of \emph{small} types,
with the following reduction.
Let $S_t$ denote the subset of cardinality $2^{n - 1}$, type $t$,
with the minimum $\theta$, that is, $\theta(S_t) = \theta(n, 2^{n - 1}, t)$.
We define the following operation on paths, $P \rightarrow P'$:
\begin{equation*}
\{P_1, P_2, \dots, P_{2^{n - 1}}\} \rightarrow \{P_1', P_2', \dots, P_{2^{n - 1}}'\}.
\end{equation*}
with
\begin{enumerate}[(i)]
	\item $P_i' = P_i$ if $Type(P_i) \le 2^{n - 3}$,
	\item $P_i' = S_{2^{n - 3}}$ if $Type(P_i) > 2^{n - 3}$.
\end{enumerate}

Given $P = \{P_1, P_2, \dots, P_{2^{n - 1}}\}$, we abbreviate
\begin{equation*}
\Theta(P) = \theta(P_1) + \theta(P_2) + \cdots + \theta(P_{2^{n - 1}}).
\end{equation*}
$\Theta(P') \le \Theta(P)$ is clear by the definition,
since $\theta(P_i') \le \theta(P_i)$, provided (\ref{Equation 2.3}).

If a path, $P$, contains sets of type \emph{big} and \emph{small},
the operation above takes it to $P'$ which consists of only \emph{small} sets,
and note that $P'$ maintains the two properties of a path given in Proposition \ref{Proposition 1}.

Let us look at $P'$.
We first note that $\Theta(P')$ is the sum of the $\theta(P_i')$'s,
thus we may arrange the summands anyway we see fit without changing $\Theta(P')$.
We rearrange the order and call the result $P''$.
\begin{align*}
P'' & = \{P_1'', \dots, P_{2^{n - 2}}'', \dots, P_{2^{n - 1}}''\} \\
    & = \{S_{2^{n - 3}}, \dots, S_{2^{n - 3}}, \dots, S_{2^{n - 3}}\}
\end{align*}
Let $m$ be the type of the set among $\{P_1'', P_2'', \dots, P_{2^{n - 2}}''\}$
with the minimum $\theta$ value,
and let $n$ be the type of the set among $\{P_{2^{n - 2}}'', P_{2^{n - 2} + 1}'', \dots, P_{2^{n - 2}}''\}$
with the minimum $\theta$ value.
Since $P'$ is continuous,
containing among the $P_i'$'s are sets of all types in between $2^{n - 3}$ and $m$.
There are at least two of each types in between,
one on the way down to $S_m$, and one on the way back up to $S_{2^{n - 3}}$.
Similarly, for the sets in between $2^{n - 3}$ and $n$.
Keeping exactly two of the sets in between $2^{n - 3}$ and $m$, and $2^{n - 3}$ and $n$.
Replacing the other sets with $S_m$ in the first half, and $S_n$ in the second half.
We have the following sequence:
\begin{align*}
S = \{S_{2^{n - 3}}, S_{2^{n - 3} - 1}, \dots, S_{m + 1}, S_m, \dots, S_m, S_{m + 1},
\dots, S_{2^{n - 3} - 1}, S_{2^{n - 3}}, \\
S_{2^{n - 3} - 1}, \dots, S_{n + 1}, S_n,
\dots, S_n, S_{n + 1}, \dots, S_{2^{n - 3} - 1}, S_{2^{n - 3}}\}.
\end{align*}
We have
\begin{equation*}
\Theta(P') = \Theta(P'') \ge \Theta(S).
\end{equation*}

Recall that for the Greycode,
\begin{align*}
\mathcal{G} = \{S_{2^{n - 3}}, S_{2^{n - 3} - 1}, \dots, S_1, S_0, S_1,
\dots, S_{2^{n - 3} - 1}, S_{2^{n - 3}}, \\
S_{2^{n - 3} - 1}, \dots, S_1, S_0, S_1, \dots, S_{2^{n - 3} - 1}, S_{2^{n - 3}}\}.
\end{align*}
We have $\Theta(S) \ge \Theta(\mathcal{G})$, which means
\begin{equation*}
\Theta(P) \ge \Theta(P') = \Theta(P'') \ge \Theta(S) \ge \Theta(\mathcal{G}),
\end{equation*}
proving the inequality
\begin{equation}
\label{Equation 2.4}
(k + 1) \cdot \theta(n, k) \ge \sum_{i = 0}^k \theta(n, i),
\qquad \textnormal{for } 0 \le k \le 2^{n - 1},
\end{equation}
completes the claim that the path corresponding to the greycode is the optimal.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Chapter 3 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{The $\takagi$cFunction}
\label{Chapter 3}

Before proving the two inequalities stated in the previous chapter,
we introduce an infinite analog of the solutions to the discrete isoperimetric problem on a cube.
It has a nice representation which makes some properties apparent;
many of them help to prove the inequalities in the next chapter.

We will also show that this continuous limit of the solutions to
the discrete isoperimetric problem on a cube turns out to be the same as the Takagi Function.

\section{Preliminary Definitions}
\label{Section 3.1}

The Takagi function is a continuous nowhere differentiable function
discovered by Teiji Takagi in 1903 \cite{Takagi.1973}.
The function also has been shown to have another unexpected application in combinatorics \cite{Frankl.1995}.
The following is a definition of the Takagi function, denoted by $T$.

For $x \in [0, 1]$, let
\begin{align*}
\Delta_1(x) & = \frac{1}{2} - \left|x - \frac{1}{2}\right|, \\
\Delta_n(x) & = \frac{\Delta_{n - 1}(2 x - [2 x])}{2},
\end{align*}
then,
\begin{equation*}
T(x) = \sum_{n = 1}^\infty \Delta_n(x).
\end{equation*}

\begin{note}
The graph of $\Delta_1$ is the triangle with base removed,
and $(0, 0)$, $(\frac{1}{2}, \frac{1}{2})$, $(1, 0)$ as its vertices.
$\Delta_n$ is $2^{n - 1}$ triangles with bases removed,
and $(0, 0)$, $(\frac{1}{2^n}, \frac{1}{2^n})$, $(\frac{1}{2^{n - 1}}, 0)$
as the vertices of the first triangle, lying side by side on the $x$-axis.
\end{note}

The graph of the Takagi function follows:
\begin{figure}[h!]
	\centering
	\includesvg[width = 0.8\textwidth]{figure-3-1}
\end{figure}

Recall that
\begin{equation*}
\theta(n, k) = \min_{S \in \binom{V_n}{k}} \theta(S)
\end{equation*}
denotes the solution to the discrete isoperimetric problem on $Q_n$.

The function $\takagi{}$ defined on $[0, 1]$ by
\begin{equation*}
\takagi(x) = \lim_{n \rightarrow \infty} \frac{\theta(n, [2^n x])}{2^n}
\end{equation*}
is the continuous limit of the solutions to the discrete isoperimetric problem on the cube.

\section{Main Theorem}
\label{Section 3.2}

\begin{theorem}
\label{Theorem 1}
$\takagi(x) = T(x)$.
\end{theorem}

It was shown in \cite{Harper.1964} that the lexicographic ordering on $Q_n$
(where the vertices are thought of as $n$-digit binary numbers)
gives the solution to the discrete isoperimetric problem.

That is, if $S_{n, k} \subset V_n$ is the set consisting of the first $k$ elements of $V_n$
in the lexicographic order, then for all $0 \le k \le 2^n$,
\begin{equation*}
\theta(S_{n, k}) = \theta(n, k).
\end{equation*}

Since $S_{n, 2^{n - 1}}$ and its complement in $Q_n$ are both $n - 1$ dimensional subcubes,
we have the following recursive formula:
\begin{equation}
\label{Equation 3.1}
\theta(n, k) = \begin{cases}
	\theta(n - 1, k) + k & \textnormal{if } 0 \le k \le 2^{n - 1}; \\
	\theta(n, 2^n - k) & \textnormal{if } 2^{n - 1} \le k \le 2^n.
\end{cases}
\end{equation}

This formula will be used to prove our theorem.

Since $\theta(S) = \theta(V_n \backslash S)$ for all $S \subset V_n$,
$\takagi(x)$ is symmetric about $x = \frac{1}{2}$.
Thus the theorem will be proved if we can show
\begin{equation}
\label{Equation 3.2}
\takagi(2 x) = 2 (\takagi(x) - x).
\end{equation}

\begin{note}
We have included the graph of $\takagi(x) - \Delta_1(x)$.
\end{note}
\begin{figure}[h!]
	\centering
	\includesvg[width = 0.8\textwidth]{figure-3-2}
\end{figure}

\begin{proof}[Proof of (\ref{Equation 3.2})]
Using the recursive formula (\ref{Equation 3.1}),
and the definition of $\takagi(x)$, we have
\begin{align*}
2 (\takagi(x) - x)
& = 2 \lim_{n \rightarrow \infty} \frac{\theta(n, [2^n x])}{2^n} - 2 x \\
& = 2 \lim_{n \rightarrow \infty} \left(\frac{\theta(n - 1, [2^n x])}{2^n} +
\frac{[2^n x]}{2^n}\right) - 2 n \\
& = \lim_{n \rightarrow \infty} \frac{\theta(n - 1, [2^n x])}{2^{n - 1}} + 2 x - 2 x \\
& = \lim_{n \rightarrow \infty} \frac{\theta(n - 1, [2^{n - 1} 2 x])}{2^{n - 1}} \\
& = \takagi(2 x)
\end{align*}
\end{proof}

\section{The Set of Maximums of $\takagi(x)$}
\label{Section 3.3}

The fact that $\takagi(x) = \sum_{n = 1}^\infty \Delta_n(x)$ gives us
a Cantor set type representation of the set of maximums of $\takagi(x)$.

Let us first take a look at $\Delta_1(x) + \Delta_2(x)$ whose graph is given below:
\begin{equation*}
\includesvg[width = 0.15\textwidth]{delta-1} +
\includesvg[width = 0.15\textwidth]{delta-2} =
\includesvg[width = 0.6\textwidth]{delta-1-2}
\end{equation*}

Notice that for $x \in [\frac{1}{4}, \frac{3}{4}]$, $(\Delta_1 + \Delta_2)(x) = \frac{1}{2}$.
Clearly, $\takagi$ has no maximum in the first and last fourths of the unit interval.
Note also that for $x \in [\frac{1}{4}, \frac{1}{2}] \cup [\frac{1}{2}, \frac{3}{4}]$,
\begin{equation*}
\takagi(x) = \sum_{n = 3}^\infty \Delta_n + \frac{1}{2}.
\end{equation*}
So clearly $\takagi$ has no maximum in the first and last fourths of the interval
$[\frac{1}{4}, \frac{3}{4}]$.
Thus, (by the self-similarity of $\takagi$) the set of maximums is just
\begin{equation*}
M = \{x \in [0, 1] \colon \textnormal{the base-4 representation of } x \textnormal{ contains only 1's and 2's}\}.
\end{equation*}

\section{$x \cdot \takagi(x) \ge \int_0^x \takagi(t) \mathrm{d}t$}

It is apparent from the graph of $\takagi(x)$ that, for $2^{n - 2} \le k \le 2^{n - 1}$,
\begin{equation*}
\theta(n, k) \ge \theta(n, 2^{n - 2}) = \theta(n, 2^{n - 1}).
\end{equation*}
We will first prove this fact in the next chapter to use to show the inequality
\begin{equation}
\label{Equation 3.3}
(k + 1) \cdot \theta(n, k) \ge \sum_{i = 0}^k \theta(n, i),
\end{equation}
when $2^{n - 2} \le k \le 2^{n - 1}$.

If we take the limit of (\ref{Equation 3.3}), we get
\begin{equation*}
x \cdot \takagi(x) \ge \int_0^x \takagi(t) \mathrm{d}t,
\end{equation*}
when $x \in [0, \frac{1}{2}]$.

We may rewrite this
\begin{equation*}
\takagi(x) \ge \frac{\int_0^x \takagi(t) \mathrm{d}t}{x}.
\end{equation*}
That is,
\begin{claim}
\label{Claim 2}
$\takagi(x)$ is always greater than or equal to the average value of the function
from $0$ to $x$ when $x \in [0, \frac{1}{2}]$.
\end{claim}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Chapter 4 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Inequalities}
\label{Chapter 4}

In this chapter, we prove the two inequalities in the two sections.

\section{$(k + 1) \cdot \theta(n, k) \ge \sum_{i = 0}^k \theta(n, i)$}

The first inequality, $(k + 1) \cdot \theta(n, k) \ge \sum_{i = 0}^k \theta(n, i)$,
is true for $0 \le k \le 2^{n - 1}$,
where $\theta(n, k)$ denotes the soultion to the discrete isoperimetric problem
for cardinality $k$ in the $n$-dimensional cube, $Q_n = (V_n, E_n, \partial_n)$.
\begin{equation*}
\theta(n, k) = \min_{S \in \binom{V_n}{k}} \theta(S).
\end{equation*}

We first prove two claims which will be used to prove the inequality.

\begin{claim}
\label{Claim 3}
For $2^{n - 2} \le k \le 2^{n - 1}$, $\theta(n, k) \ge \theta(n, 2^{n - 2})$.
\end{claim}
\begin{proof}
We first note that $\theta(n, 2^{n - 2}) = 2^{n - 1} = \theta(n, 2^{n - 1})$,
and recall the recursive formula for $\theta(n, k)$:
\begin{equation}
\label{Equation 4.1}
\theta(n, k) = \begin{cases}
	\theta(n - 1, k) + k & \textnormal{if } 0 \le k \le 2^{n - 1}; \\
	\theta(n, 2^n - k) & \textnormal{if } 2^{n - 1} \le k \le 2^n.
\end{cases}
\end{equation}
We proceed by induction on $n$.
\begin{enumerate}[(1)]
\item Base Case: For $n = 2$, $\theta(2, 1) = 2 = \theta(2, 2)$ is clear.
\item Induction Hypothesis:
	\begin{equation}
	\label{Equation 4.2}
	\theta(m, k) \ge \theta(m, 2^{m - 2}), \qquad
	\textnormal{for } m < n \textnormal{ when } 2^{m - 2} \le k \le 2^{m - 1}.
	\end{equation}
	We want to show that $\theta(n, k) \ge \theta(n, 2^{n - 2})$,
	for $2^{m - 2} \le k \le 2^{m - 1}$.

	Staring with $\theta(n, k)$, we have
	\begin{align*}
	\theta(n, k) & = \theta(n - 1, k) + k \tag{by \ref{Equation 4.1}} \\
		     & = \theta(n - 1, 2^{n - 1} - k) + k. \tag{by \ref{Equation 4.1}}
	\end{align*}
	We break it into two cases from here.

	\textbf{CASE I.} $2^{n - 2} \le k \le 3 \cdot 2^{n - 3}$.
	\begin{equation*}
	2^{n - 2} \le k \le 3 \cdot 2^{n - 3} \iff 2^{n - 3} \le (2^{n - 1} - k) \le 2^{n - 2},
	\end{equation*}
	so, we have
	\begin{align*}
	\theta(n - 1, (2^{n - 1} - k)) + k
	& \ge \theta(n - 1, 2^{n - 2}) + 2^{n - 2} \tag{by \ref{Equation 4.2}} \\
	& = \theta(n, 2^{n - 2}). \tag{by \ref{Equation 4.1}}
	\end{align*}
	\textbf{CASE II.} $3 \cdot 2^{n - 3} \le k \le 2^{n - 1}$.
	\begin{equation*}
	3 \cdot 2^{n - 3} \le k \le 2^{n - 1} \iff 0 \le (2^{n - 1} - k) \le 2^{n - 3},
	\end{equation*}
	so, we have
	\begin{align*}
	\theta(n - 1, (2^{n - 1} - k)) + k
	& = \theta(n - 2, (2^{n - 1} - k)) + (2^{n - 1} - k) + k \tag{by \ref{Equation 4.1}} \\
	& = \theta(n - 2, (2^{n - 1} - k)) + 2^{n - 1} \\
	& \ge 2^{n - 1} \\
	& = \theta(n, 2^{n - 2}).
	\end{align*}
\end{enumerate}
\end{proof}

We now prove the special case of the inequality when $k = 2^{n - 1}$, that is,
\begin{equation*}
(2^{n - 1} + 1) \cdot \theta(n, 2^{n - 1}) \ge \sum_{i = 0}^{2^{n - 1}} \theta(n, i).
\end{equation*}
Since
\begin{align*}
(2^{n - 1} + 1) \cdot \theta(n, 2^{n - 1})
& = (2^{n - 1} + 1) \cdot 2^{n - 1} \\
& = (2^{n - 1})^2 + 2^{n - 1} \\
& \ge (2^{n - 1})^2,
\end{align*}
the special case will be proved by showing the next claim.

\begin{claim}
\label{Claim 4}
$\sum_{i = 0}^{2^{n - 1}} \theta(n, i) = (2^{n - 1})^2$.
\end{claim}
\begin{proof}
By induction,
\begin{enumerate}[(1)]
\item Base Case: For $n = 1$,
	\begin{align*}
	\sum_{i = 0}^1 \theta(1, i)
	& = \theta(1, 0) + \theta(1, 1) \\
	& = 0 + 1 \\
	& = 1^2
	\end{align*}
\item Induction Hypothesis:
	\begin{equation}
	\label{Equation 4.3}
	\textnormal{For } m < n, \qquad
	\sum_{i = 0}^{2^{m - 1}} \theta(n, i) = (2^{m - 1})^2.
	\end{equation}
	We want to show that $\sum_{i = 0}^{2^{n - 1}} \theta(n, i) = (2^{n - 1})^2$.
	\begin{align*}
	\sum_{i = 0}^{2^{n - 1}} \theta(n, i)
	& = \sum_{i = 0}^{2^{n - 1}} (\theta(n - 1, i) + i) \tag{by \ref{Equation 4.1}} \\
	& = \sum_{i = 0}^{2^{n - 1}} \theta(n - 1, i) + \sum_{i = 0}^{2^{n - 1}} i \\
	& = \sum_{i = 0}^{2^{n - 2}} \theta(n - 1, i) +
	    \sum_{i = 2^{n - 2} + 1}^{2^{n - 1}} \theta(n - 1, i) + \sum_{i = 0}^{2^{n - 1}} i \\
	& = 2 \sum_{i = 0}^{2^{n - 2}} \theta(n - 1, i) - \theta(n - 1, 2^{n - 2}) +
	    \sum_{i = 0}^{2^{n - 1}} i \tag{by \ref{Equation 4.1}} \\
	& = 2 (2^{n - 2})^2 - 2^{n - 2} + \sum_{i = 0}^{2^{n - 1}} i \tag{by \ref{Equation 4.3}} \\
	& = 2 (2^{n - 2})^2 - 2^{n - 2} + \frac{2^{n - 1}(1 + 2^{n - 1})}{2} \\
	& = 2 (2^{n - 2})^2 - 2^{n - 2} + \frac{2^{n - 1}}{2} + \frac{(2^{n - 1})^2}{2} \\
	& = 2 (2^{n - 2})^2 + 2 (2^{n - 2})^2 \\
	& = (2^{n - 1})^2.
	\end{align*}
\end{enumerate}
We are done with Claim \ref{Claim 4}.
\end{proof}

\begin{theorem}
\label{Theorem 2}
For $0 \le k \le 2^{n - 1}$,
$(k + 1) \cdot \theta(n, k) \ge \sum_{i = 0}^k \theta(n, i)$.
\end{theorem}
\begin{proof}
By induction,
\begin{enumerate}[(1)]
\item Base Case: $n = 1$.

	If $k = 0$, then
	\begin{equation*}
	(0 + 1) \cdot \theta(1, 0) = \theta(1, 0) = \sum_{i = 0}^0 \theta(1, i).
	\end{equation*}
	If $k = 1$, then
	\begin{equation*}
	(1 + 1) \cdot \theta(1, 1) = 2 \cdot 1 \ge
	0 + 1 = \theta(1, 0) + \theta(1, 1) = \sum_{i = 0}^1 \theta(1, i).
	\end{equation*}
\item Induction hypothesis:
	\begin{equation}
	\label{Equation 4.4}
	\textnormal{For } m < n, \qquad 0 \le k \le 2^{m - 1}, \qquad
	(k + 1) \cdot \theta(n, k) \ge \sum_{i = 0}^k \theta(1, i).
	\end{equation}
	We want to show that $(k + 1) \cdot \theta(n, k) \ge \sum_{i = 0}^k \theta(1, i)$,
	for $0 \le k \le 2^{n - 1}$.

	There are two cases.

	\textbf{CASE I.} $0 \le k \le 2^{n - 2}$.
	\begin{align*}
	(k + 1) \cdot \theta(n, k)
	& = (k + 1) \cdot (\theta(n - 1, k) + k) \tag{by \ref{Equation 4.1}} \\
	& = (k + 1) \cdot \theta(n - 1, k) + (k + 1) \cdot k \\
	& \ge \sum_{i = 0}^k \theta(n - 1, i) + (k^2 + k) \tag{by \ref{Equation 4.4}} \\
	& \ge \sum_{i = 0}^k \theta(n - 1, i) + \sum_{i = 0}^k i \\
	& = \sum_{i = 0}^k (\theta(n - 1, i) + i) \\
	& = \sum_{i = 0}^k \theta(n, i). \tag{by \ref{Equation 4.1}}
	\end{align*}

	\textbf{CASE II.} $2^{n - 2} \le k \le 2^{n - 1}$.

	Suppose not, that is,
	\begin{equation}
	\label{Equation 4.5}
	(k + 1) \cdot \theta(n, k) < \sum_{i = 0}^k \theta(n, i),
	\end{equation}
	then
	\begin{align*}
	\sum_{i = 0}^{2^{n - 1}} \theta(n, i)
	& = \sum_{i = 0}^k \theta(n, i) + \sum_{i = k + 1}^{2^{n - 1}} \theta(n, i) \\
	& > (k + 1) \cdot \theta(n, k) + \sum_{i = k + 1}^{2^{n - 1}} \theta(n, i) \tag{by \ref{Equation 4.5}} \\
	& \ge (k + 1) \cdot \theta(n, 2^{n - 1}) + \sum_{i = k + 1}^{2^{n - 1}} \theta(n, i) \tag{by Claim \ref{Claim 3}} \\
	& \ge (k + 1) \cdot \theta(n, 2^{n - 1}) + (2^{n - 1} - k) \cdot \theta(n, 2^{n - 1}) \tag{by Claim \ref{Claim 3}} \\
	& = (k + 1 + 2^{n - 1} - k) \cdot \theta(n, 2^{n - 1}) \\
	& = (2^{n - 1} + 1) \cdot \theta(n, 2^{n - 1}). \numberthis \label{Equation 4.6}
	\end{align*}
	(\ref{Equation 4.6}) contradicts the special case we took care of in Claim \ref{Claim 4}.
\end{enumerate}
This completes the proof to the theorem.
\end{proof}

\section{$\theta(n, 2^{n - 1}, t) \ge \frac{3}{4} \cdot 2^n$, when $2^{n - 3} \le t \le 2^{n - 2}$}
\label{Section 4.2}

Recall that $\theta(n, k, t)$ denotes $\theta$ values of subsets of cardinality $k$,
type $t$, in an $n$-dimensional cube.

We first introduce the function,
$f \colon \mathbb{R} \rightarrow (-\infty, \frac{3}{4}]$,
\begin{equation*}
f(x) = \frac{3}{4} - \frac{64}{7} (x - \frac{1}{2})^2.
\end{equation*}
$f(x)$ is a parabola with downward concavity, and vertex $(\frac{1}{2}, \frac{3}{4})$.
We also restrict our attention of the function to the interval $[0, 1]$.

We will first verify that
\begin{claim}
\label{Claim 5}
$f(x - t) + f(x + t) + 2 t \ge 2 f(x)$, when $0 \le t \le \frac{7}{64}$.
\end{claim}
\begin{proof}
\begin{align*}
  & f(x - t) + f(x + t) + 2 t \\
= & \frac{3}{4} - \frac{64}{7} ((x - t) - \frac{1}{2})^2 +
    \frac{3}{4} - \frac{64}{7} ((x + t) - \frac{1}{2})^2 + 2 t \\
= & 2 (\frac{3}{4}) - \frac{64}{7} \left(((x - t) - \frac{1}{2})^2 +
    ((x + t) - \frac{1}{2})^2\right) + 2 t \\
= & 2 (\frac{3}{4}) - \frac{64}{7} \left((x - t)^2 - (x - t) + \frac{1}{4} +
    (x + t)^2 - (x + t) + \frac{1}{4}\right) + 2 t \\
= & 2 (\frac{3}{4}) - \frac{64}{7} (x^2 - 2 x t + t^2 - x + t + 2 (\frac{1}{4}) +
    x^2 + 2 x t + t^2 - x - t) + 2 t \\
= & 2 (\frac{3}{4}) - \frac{64}{7} (2 x^2 + 2 t^2 - 2 x + 2 (\frac{1}{4})) + 2 t \\
= & 2 (\frac{3}{4} - \frac{64}{7} (x^2 - x + \frac{1}{4} + t^2) + t) \\
= & 2 (\frac{3}{4} - \frac{64}{7} (x - \frac{1}{2})^2 - \frac{64}{7} t^2 + t) \\
= & 2 (\frac{3}{4} - \frac{64}{7} (x - \frac{1}{2})^2) - 2 (\frac{64}{7}) (t^2 - \frac{7}{64} t) \\
= & 2 f(x) - 2 (\frac{64}{7}) (t^2 - \frac{7}{64} t).
\end{align*}

$t^2 - \frac{7}{64} t \le 0$, we have $f(x - t) + f(x + t) + 2 t \ge 2 f(x)$.

$t^2 - \frac{7}{64} t = t (t - \frac{7}{64})$, which is $\le 0$ when $0 \le t \le \frac{7}{64}$.

This completes the proof of the claim.
\end{proof}

In the following claim, $x$ and $y$ are dyadic rationals with denominator $2^n$.
\begin{claim}
\label{Claim 6}
For all $n$, when $\frac{1}{24} \le y \le \frac{1}{24} + \frac{7}{64}$,
and $x \in [0, \frac{1}{2}]$,
\begin{equation*}
\theta(n, 2^n x, 2^n y) \ge f(x) \cdot 2^n.
\end{equation*}
\end{claim}
\begin{proof}
Recall from Chapter \ref{Chapter 2}, the inequality (\ref{Equation 2.1}),
\begin{align*}
\theta(n, 2^n x, 2^n y)
& \ge \theta(n - 1, 2^n y) + \theta(n - 1, 2^n (x - y)) + 2^n x - 2 \cdot 2^n y \\
& = 2^n \left(\frac{\theta(n - 1, 2^n y)}{2^n} + \frac{\theta(n - 1, 2^n (x - y))}{2^n} + x - 2 y
	\right) \\
& = 2^n \left(\frac{1}{2} \cdot \frac{\theta(n - 1, 2^n y)}{2^{n - 1}} +
	      \frac{1}{2} \cdot \frac{\theta(n - 1, 2^n (x - y))}{2^{n - 1}} + x - 2 y
	\right).
\end{align*}
To complete the proof of the claim, we need to verify that
\begin{equation*}
\frac{1}{2} \cdot \frac{\theta(n - 1, 2^n y)}{2^{n - 1}} +
\frac{1}{2} \cdot \frac{\theta(n - 1, 2^n (x - y))}{2^{n - 1}} + x - 2 y \ge f(x).
\end{equation*}
Using results from the $\takagi$cFunction and equation (\ref{Equation 3.2}),
we noticed that
\begin{equation*}
\frac{\theta(n - 1, 2^{n - 1} 2 y)}{2^{n - 1}} = \takagi(2 y) = 2 (\takagi(y) - y)
\end{equation*}
and
\begin{equation*}
\frac{\theta(n - 1, 2^{n - 1} 2 (x - y))}{2^{n - 1}}
= \takagi(2 (x - y))
= 2 (\takagi(x - y) - (x - y))
\end{equation*}
at the dyadic rationals.

We also have
\begin{equation*}
\sum_{i = 1}^\infty \Delta_i(x) = \takagi(x),
\end{equation*}
so the partial sum
\begin{equation*}
\sum_{i = 1}^\infty \Delta_i(x) \le \takagi(x)
\end{equation*}
for every $n$.
We replace the statement we need to verify,
\begin{equation*}
\frac{1}{2} \cdot \frac{\theta(n - 1, 2^n y)}{2^{n - 1}} +
\frac{1}{2} \cdot \frac{\theta(n - 1, 2^n (x - y))}{2^{n - 1}} + x - 2 y \ge f(x)
\end{equation*}
by
\begin{equation*}
\takagi(y) - y + \takagi(x - y) - (x - y) + (x - 2 y)
= \takagi(y) + \takagi(x - y) - 2y
\ge f(x).
\end{equation*}
And verify that
\begin{equation}
\label{Equation 4.7}
\sum_{i = 1}^n \Delta_i(y) + \sum_{i = 1}^n \Delta_i(x - y) - 2 y \ge f(x)
\end{equation}
for some $n$.

Let us denote the left hand side of the inequality (\ref{Equation 4.7}) by $a(x, y)$
when $n = 11$.

Let $\{c_0, c_1, c_2, \dots, c_{2^{11}}\}$ enumerate the dyadic rationals
between $0$ and $\frac{1}{2}$ which have $2^{12}$ in the denominator.

Let $\{d_0, d_1, d_2, \dots, d_k\}$ enumerate the dyadic rationals
between $\frac{1}{24}$ and $(\frac{1}{24} + \frac{7}{64})$ which have $2^{12}$
in the denominator.
We verified on the computer that for all possible $j$ and $k$,
\begin{align*}
a(c_j, d_k) & \ge f(c_j), \\
a(c_j, d_k) & \ge f(c_{j + 1}).
\end{align*}
Since $a(x, y)$ is linear on the square with sides $\frac{1}{2^{12}}$
and $f(x)$ is a parabola which is increasing between $0$ and $\frac{1}{2}$,
for all $x$ with $c_j \le x \le c_{j + 1}$, and all $y$ with $d_k \le y \le d_{k + 1}$
we have
\begin{equation*}
a(x, y) \ge \min\{a(c_j, d_k), a(c_{j + 1}, d_k)\} \ge f(c_{j + 1}) \ge f(x).
\end{equation*}
We conclude thus
\begin{equation*}
a(x, y) \ge f(x).
\end{equation*}
This completes the proof of the claim.
\end{proof}

\begin{theorem}
\label{Theorem 3}
For $n \ge 5$, $y \ge \frac{1}{24} + \frac{7}{64}$, and $x \in [0, 1]$,
\begin{equation*}
\theta(n, 2^n x, 2^n y) \ge f(x) \cdot 2^n.
\end{equation*}

The inequality (\ref{Equation 2.3}),
\begin{equation*}
\theta(n, 2^{n - 1}, t) \ge \frac{3}{4} \cdot 2^n, \quad
\textnormal{when } 2^{n - 3} \le t \le 2^{n - 2},
\end{equation*}
is a special case of Theorem \ref{Theorem 3},
when $\frac{1}{8} \le y \le \frac{1}{4}$ and $x = \frac{1}{2}$.
\end{theorem}
\begin{proof}
We prove this theorem by induction.
\begin{enumerate}[(1)]
\item Base Case:
	\begin{equation*}
	\theta(n, 2^5 x, 2^5 y) \ge f(x) \cdot 2^5,
	\textnormal{when } y \ge \frac{1}{24} + \frac{7}{64},
	\textnormal{and } x \in [0, 1]
	\end{equation*}
	is verified by the computer.
\item Induction Hypothesis:
	\begin{equation*}
	\theta(m, 2^m x, 2^m y) \ge f(x) \cdot 2^m,
	\textnormal{if } m < n, y \ge \frac{1}{24} + \frac{7}{64},
	\textnormal{and } x \in [0, 1].
	\end{equation*}
	Given that $x \in [0, 1]$, and $y \ge \frac{1}{24} + \frac{7}{64}$,
	we want to show that
	\begin{equation*}
	\theta(n, 2^n x, 2^n y) \ge f(x) \cdot 2^n.
	\end{equation*}
	Let $S \subseteq V_n$ with $|S| = 2^n x$, and $Type(S) = 2^n y$.

	Divide $S$ along the division that gives $|S_1 \Delta S_2| \le \frac{7}{64} \cdot 2^n$.

	We note that such a division must exist, or we are done.
	If
	\begin{equation*}
	|S_1 \Delta S_2| > \frac{7}{64} \cdot 2^n,
	\end{equation*}
	then
	\begin{equation*}
	\theta(S) > \frac{7}{64} \cdot n \cdot 2^n.
	\end{equation*}
	When $n > 7$,
	\begin{equation*}
	\frac{7}{64} \cdot n \cdot 2^n > \frac{3}{4} \cdot 2^n \ge f(x) \cdot 2^n.
	\end{equation*}
	We note that $\frac{3}{4}$ is the maximum value for $f(x)$.
	We are done.

	When $n = 6$, if
	\begin{equation*}
	|S_1 \Delta S_2| > \frac{7}{64} \cdot 2^6 = 7,
	\end{equation*}
	then
	\begin{equation*}
	|S_1 \Delta S_2| \ge 8.
	\end{equation*}
	So,
	\begin{equation*}
	\theta(S) \ge 6 \cdot 8 = 48 \ge \frac{3}{4} \cdot 2^6 \ge f(x) \cdot 2^6.
	\end{equation*}
	We are again done.

	We have $S \subseteq V_n$, $|S| = 2^n x$,
	and $Type(S) \ge (\frac{1}{24} + \frac{7}{64}) \cdot 2^n$,
	with $S$ partitioned into $S_1$ and $S_2$, $S = S_1 \cup S_2$,
	$|S_1 \Delta S_2| \le \frac{7}{64} \cdot 2^n$,
	and we assume that $|S_1| \ge |S_2|$.
	There are two cases which we will consider separately.

	\textbf{CASE I.} $|S_1| \le 2^{n - 2}$.

	Let $|S_1| - |S_2| = 2^n t$, we have the following system of equations:
	\begin{align*}
	|S_1| - |S_2| & = 2^n t, \\
	|S_1| + |S_2| & = 2^n x.
	\end{align*}
	Solving for $|S_1|$ and $|S_2|$, we have that
	\begin{align*}
	|S_1| & = \frac{2^n x + 2^n t}{2} = (x + t) \cdot 2^{n - 1}, \\
	|S_2| & = \frac{2^n x - 2^n t}{2} = (x - t) \cdot 2^{n - 1}.
	\end{align*}
	Let $Type(S_i) = w_i \cdot 2^{n - 1}$.

	Let $w \cdot 2^{n - 1} = \min\{w_1 \cdot 2^{n - 1}, w_2 \cdot 2^{n - 1}\}$.

	Then
	\begin{align*}
	w \cdot 2^{n - 1} + w \cdot 2^{n - 1} + \frac{7}{64} \cdot 2^n & \ge Type(S) \\
	2 \cdot 2^{n - 1} w + \frac{7}{64} \cdot 2^n & \ge (\frac{1}{24} + \frac{7}{64}) \cdot 2^n \\
	2 \cdot 2^{n - 1} w & \ge (\frac{1}{24} + \frac{7}{64}) \cdot 2^n - \frac{7}{64} \cdot 2^n \\
	2 \cdot 2^{n - 1} w & \ge \frac{1}{24} \cdot 2^n \\
	w & \ge \frac{1}{24}.
	\end{align*}
	So we conclude that $w_i \ge \frac{1}{24}$,
	together with Claim \ref{Claim 4}, Claim \ref{Claim 5},
	and the Induction Hypothesis, we compute
	\begin{align*}
	\theta(S)
	& \ge \theta(S_1) + \theta(S_2) + t \cdot 2^n \\
	& \ge f(x + t) \cdot 2^{n - 1} + f(x - t) \cdot 2^{n - 1} + 2 t \cdot 2^{n - 1} \\
	& \ge 2^{n - 1} (2 f(x)) \\
	& \ge 2^n f(x).
	\end{align*}
	This completes CASE I.

	\textbf{CASE II.} $|S_1| > 2^{n - 2}$.
	\begin{enumerate}[(i)]
	\item Let $h = |S_1 \backslash S_2|$ in $|S_1 \Delta S_2|$, and
	\item let $l = |S_2 \backslash S_1|$ in $|S_1 \Delta S_2|$.
	\end{enumerate}
	$h + l = |S_1 \Delta S_2| \le \frac{7}{64} \cdot 2^n$, and
	\begin{align*}
	|S_1| + |S_2| & = |S|, \\
	|S_1| - |S_2| & = (h - l).
	\end{align*}
	Solving the system of equations, we have
	\begin{align*}
	|S_1| & = \frac{|S|}{2} + \frac{h - l}{2}, \\
	|S_2| & = \frac{|S|}{2} - \frac{h - l}{2}.
	\end{align*}
	Let $w_i \cdot 2^{n - 1} = Type(S_i)$,
	and $w \cdot 2^{n - 1} = \min\{Type(S_1), Type(S_2)\}$.
	If $w = w_2$, we are done, the proof proceeds exactly as CASE I.
	Otherwise, we first calculate the $Type(S_1^C)$.

	We prove first the following claim.
	\begin{claim}
	\label{Claim 7}
	Let $c = |S_1| - 2^{n - 2}$, then $Type(S_1^C) = Type(S_1) - c$.
	\end{claim}
	\begin{proof}
	\begin{align*}
	Type(S_1^C)
	& = 2^{n - 2} - (|S_1| - Type(S_1)) \\
	& = 2^{n - 2} - |S_1| + Type(S_1) \\
	& = 2^{n - 2} - (2^{n - 2} + c) + Type(S_1) \\
	& = 2^{n - 2} - 2^{n - 2} - c + Type(S_1) \\
	& = Type(S_1) - c.
	\end{align*}
	\end{proof}
	We also make the following calculation:
	\begin{align*}
	|S_1| & = \frac{|S|}{2} + \frac{h - l}{2} \\
	      & \le \frac{2^{n - 1}}{2} + \frac{h - l}{2} \\
	      & = 2^{n - 2} + \frac{h - l}{2}.
	\end{align*}
	Since
	\begin{equation*}
	|S_1| = 2^{n - 2} + c,
	\end{equation*}
	we conclude from the above calculation
	\begin{equation*}
	c \le \frac{h - l}{2}.
	\end{equation*}
	\begin{align*}
	Type(S_1) + (Type(S_1) + l) & \ge Type(S) \\
	2 \cdot Type(S_1) + l & \ge Type(S) \\
	2 \cdot Type(S_1) & \ge Type(S) - l \\
	Type(S_1) & \ge \frac{Type(S) - l}{2}.
	\end{align*}
	From Claim \ref{Claim 7}, and earlier calculation,
	\begin{align*}
	Type(S_1^C)
	& = Type(S_1) - c \\
	& \ge Type(S_1) - \frac{h - l}{2} \\
	& \ge \frac{Type(S) - l}{2} - \frac{h - l}{2} \\
	& = \frac{1}{2} (Type(S) - h) \\
	& \ge \frac{1}{2} ((\frac{1}{24} + \frac{7}{64}) \cdot 2^n - \frac{7}{64} \cdot 2^n) \\
	& = \frac{1}{2} (\frac{1}{24} \cdot 2^n) \\
	& = \frac{1}{24} \cdot 2^{n - 1}.
	\end{align*}
	We abbreviate $Type(S_1^C)$ with $w^C$.

	We note that $w_2 \ge w_1 \ge w^C + c \ge \frac{1}{24} \cdot 2^{n - 1}$.

	It is now possible to proceed with the induction, since
	\begin{align*}
	\theta(S)
	& \ge \theta(S_1) + \theta(S_2) + (h - l) \cdot 2^n \\
	& = \theta(S_1^C) + \theta(S_2) + (h - l) \cdot 2^n \\
	& \ge 2^{n - 1} \cdot f(1 - (x + (h - l))) +
	      2^{n - 1} \cdot f(x - (h - l)) + 2 \cdot (h - l) \cdot 2^{n - 1} \\
	& = 2^{n - 1} \cdot f(x + (h - l)) + 2^{n - 1} \cdot f(x - (h - l)) +
	    2 \cdot (h - l) \cdot 2^{n - 1} \\
	& = 2^{n - 1} (f(x + (h - l)) + f(x - (h - l)) + 2 \cdot (h - l)) \\
	& \ge 2^{n - 1} (2 f(x)) \\
	& = 2^n f(x).
	\end{align*}
\end{enumerate}
The proof is complete!
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Chapter 5 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Conclusion}
\label{Chapter 5}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Bibliography %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{thebibliography}{9}

\bibitem{Harper.2004}
	L. H. Harper,
	\emph{Global Methods for Combinatorial Isoperimetric Problems},
	Cambridge University Press, 2004.

\bibitem{Harper.1964}
	L. H. harper,
	\emph{Optimal assignments of numbers to vertices},
	J. SIAM, vol. 12, pp. 131-135, 1964.

\bibitem{Chavez.1998}
	J. D. Chavez, R. Trapp,
	\emph{The cyclic cutwidth of trees},
	Discrete Applied Mathematics, vol. 87, pp. 25-32, 1998.

\bibitem{Bezrukov.1998}
	S. L. Bezrukov, U.-P. Schroeder,
	\emph{The cyclic wirelength of trees},
	Discrete Applied Mathematics, vol. 87, pp. 275-277, 1998.

\bibitem{Bezrukov.2000}
	S. L. Bezrukov, J. D. Chavez, L. H. Harper, M. RÃ¶ttger, U.-P. Schroeder,
	\emph{The Congestion of $n$-Cube Layout on a Rectangular Grid},
	Discrete Mathematics, vol. 213, pp. 13-19, 2000.

\bibitem{Frankl.1995}
	P. Frankl, M. Matsumoto, I. Z. Ruzsa, N. Tokushige,
	\emph{Minimum Shadows in Uniform Hypergraphs and a generalization of the Takagi Function},
	J. Combinatorial Theory, Series A, vol. 69, pp. 125-148, 1995.

\bibitem{Takagi.1973}
	T. Takagi,
	\emph{The Collected Papers of Teiji Takagi},
	Iwanami Shoten, 1973.

\bibitem{Garey.1979}
	M. R. Garey, D. S. Johnson,
	\emph{Computers and Intractability: A Guide to the Theory of NP-Completeness},
	W. H. Freeman and Company, 1979.

\bibitem{Steiglitz.1965}
	K. Steiglitz, A. J. Bernstein,
	\emph{Optimal binary coding of ordered numbers},
	J. SIAM, vol. 13, pp. 441-443, 1965.

\end{thebibliography}

\end{document}
